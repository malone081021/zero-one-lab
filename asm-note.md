# 前言
汇编语言最接近机器，能帮助我们了解计算机或者CPU的工作原理
每种CPU对应的汇编语言都不一样，原则使用8086CPU作为实践的对象
现在CPU都是8086的兼容CPU
本书为了教学汇编语言而精心编写的
1. 教学思想，循序渐进，成体系，有深度；
2. 教学线索
3. 大的的任务拆分
4. 知识的屏蔽，突出当前的知识点，屏蔽之后的知识点
5. 学习中包括知识点、检测点、实验
6. 注意没有通过检测点不要向下学习
7. 注意没有完成当前的实验不要向下学习
8. 重点理解计算机的工作原理和培养底层编程意识

## debug 使用

-d 2000:0 ;查看数据段的内容

-e 2000:0 ；保存数据

-a 输入汇编指令

内存和寄存器之间的数据额传输

ds:[0] // 表示内存


# 第一章 基础知识
硬件系统结构
如何利用**硬件系统的编程结构**和**指令集**有效灵活地控制系统进行工作

学习汇编需要硬件知识，但是我们现在学习简单的硬件知识结构，以后需要以后再学习

1. 为什么需要学习硬件知识

   汇编语言是直接在硬件之上工作的语言，汇编语言是机器指令的映射

2. 机器指令啥

   计算机可以指令的命令，计算机就是指令这些命令的一个机器；例如士兵可以执行的命令

   计算机有指令集，也就是他可以执行的指令是有限的

   指令是机器和人之间交互的接口，例如士兵和指挥官直接交互的接口就是命令

3. 硬件和指令之间的关系

   硬件负责实现指令，例如add 加法指令有对应的加法器（电子器件上）实现

> 汇编语言课程不深入了解硬件系统，知识了解大概的原理，帮助使用汇编语言。更多的关于硬件的课程内容在《微机原理和接口》或者《组成原理》

汇编语言的课程的重点是如何利用硬件系统的**编程结构**和**指令集**有效灵活的控制系统进行工作

### 问题

1. 啥是硬件系统的编程结构？
2. 

## 1.1 机器语言

机器语言:机器指令的集合,一台机器可以执行的命令

电子计算机受点的驱动，能接受的都是电信号，所以讲01的二级制指令转化成电信号，驱动机器工作

计算机的概念：计算机是由CPU 和其他受CPU直接或者间接控制的芯片、器件、设备组成的计算机系统。

CPU就是可以执行机器执行的器件

硬件不同的CPU，由于硬件设计和内部结构的不同，就需要不同的电平脉冲来控制，是他工作。所以不同的微处理器或者CPU 都有自己的指令集或者机器语言，所以就有不同的汇编语言；例如不同的函数，有不同额输入参数。

最原始的编程就是直接使用及指令，也就是01的代码。

**理解汇编语言的诞生**

直接是用机器指令或者01指令很可怕，书写错误不好找。暴露太多的细节，并不是好事

思想，引入中间层让编写简单，编译器

使用汇编语言编写，使用编译器编译成机器语言，解决

> 面向机器或者硬件编程，直接使用机器语言，太琐碎，暴露太多的细节，所以需要跟抽象的语言
>
> 计算机的世界是不是总是从抽象到具体的细节，在从细节到抽象

---

**第一遍的笔记**

机器可以执行的命令
指令 = 二进制数字
二进制数字转化成一列工地电平，驱使电子器件工作

微处理器，由于内部设计结构的不同，所以就需要不同的电平脉冲控制，是他工作；所以不同的微处理器有不同的机器语言，所以有不同的汇编语言

实例，展示，机器代码完成简答的任务

## 1.2 汇编语言的产生

机器指令不便于记忆和辨别

汇编指令是机器指令便于记忆的书写格式，机器指令的映射

另一种说法汇编指令是助记符
便于书写、便于记忆，**mov ax,bx**
寄存器是CPU中一个存储数据的器件
使用汇编指令编程源程序，编译器编译成机器语言

![](https://user-gold-cdn.xitu.io/2020/7/27/17390e5cabf3049e?w=1774&h=339&f=png&s=205652)

> 汇编语言的出现很自然，就是为了更高效的工作
>
> 便于记忆，更接近人类语言，便于找出书写错误等等

## 1.3 汇编语言的组成

> 上界所的是汇编语言的诞生，现在说说汇编语言的组成
>
> 汇编语言是机器指令的映射，那么汇编语言应该也是指令的集合



汇编指令

1. 汇编指令,机器指令的助记符，mov、add等。有对应的机器指令，【这个是汇编语言的核心】
2. 伪指令：没有对应的机器指令，是编译器能听懂的语言，需要编译器执行
3. 其他符号：+ 、-、*、/等，由编译器识别，没有对应的机器码，最终还是转化成机器码吧 ？？？

### 问题

不能直接找到对应机器码的指令，是否将他们间接的转化成那种机器指令，怎么验证？？

## 1.4 存储器

CPU 的核心工作是，控制整个计算机并进行运算

CPU在计算的过程中必须提供相应的数据和指令，而这些数据和指令就是需要存储，所以需要存储器

这里的存储器指，内存，内存比如计算机的记忆功能，人没有记忆的功能就不能工作。另一种存储器件是硬盘，但是硬盘上的数据也要加载到内存中才能知道CPU 工作。

**重点了解CPU是怎样读取内存中的信息和怎样写入信息**

 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0a3582a6b304b8a9ea7facf19497068~tplv-k3u1fbpfcp-zoom-1.image" width = "200"  alt="图片名称" align="center" />

## 1.5 指令和数据
同样的数据，有可能是指令或者数据，怎样判断？

同样的数据或者信息，他是指令还是数据，不知道，只有在真正的环境中才能知道

例如，10001000111011000，他既可以是数据89D8H，也可以是指令:mov ax,bx

10001000111011000 -> 89D8H

10001000111011000 -> mov ax,bx

主要还是看环境，什么是环境呢？就是CPU中各种的寄存器，这些寄存器中的值就是CPU工作的环境或者参数，那些是执行的指令是由CS:IP 指定的，那些是数据是由ds、ss等指定的

**那是什么什么指定的？以及有谁来指定的呢？**

猜测是由编译器和操作系统指定的，继续往下看

## 1.6 存储单元

> 对存储单元的规划和管理

存储器被规划成若干存储单元，编号从0开始，例如128存储单元，编号0 ~ 127；

微型机存储容量是以字节为最小单位来计算的，就是存储单元的存储容量的最小度量单位是字节(Byte)

其他的存储器的容量单元，

1KB = 1024B

1MB = 1024KB

1GB = 1024MB

1TB = 1024GB

## 1.7 CPU 对存储器的读写

> 重点来了

我们对存储器进行了规划，为读写做好了准备

在对存储进行读写的时候，有三信息需要传输，

1. 地址信息，我们要对那个存储单元进行操作
2. 具体进行什么操作，读或者写
3. 写或者新的数据

> 为什么分这么开，为什么不直接一次传输

CPU 和存储器之间有多种线连接，数据总线、控制总线、地址总线，对应上面的三种信息。

CPU就是通过这三种总线，上面的三种信息传输到存储器中的，完成对存储器的读和写

下面是一个数据读取的过程

1. 通过地址总线将地址信息发出，例如3号单元
2. 通过控制总线发出读的命令，选中存储器芯片【谁选中芯片】，并通知它【通知存储芯片？】，将要存中读取数据。
3. 存储器将3号单元中的数据8通过数据线送入CPU

这个汇编语言有什么关系呢？

`mov ax,[3]`

含义，就是讲3号单元中的数据送入ax寄存器中

总结:

1. CPU运行需要指令和数据，来自存储器，内存
2. 我们将内存规划为若干的单元，字节，方便访问、读写等
3. 内存和CPU通信需要三种信息的传输
   1. 地址信息，指定我们要对那个单元操作
   2. 指令，对单元进行的操作指令，读或者写
   3. 数据，需要读或者写的数据
4. 落实到汇编语言:mov ax,[3]

> 最后的汇编语言只体现了我们对存储单元的管理，[3];
>
> 但是我们学习很多其他的CPU和内存通信的细节并没有体现出来

CPU 对存储器的读写，是**双向的通信**，CPU 送入或者发出信息，**存储接**受到，做各种准备，将数据放入预定的总线

# 寄存器
CPU 内部和外部都有总线，内部总线实现内部计算器、控制器、
寄存器之前的连接和通信，外部总线负责主板不同器件的链接

汇编程序员通过读写寄存器的内容控制CPU的运行

其他程序员呢？修改内存的内容？

## 通用寄存器
AX、BX、CX、DX 为通用寄存器
一个16位的寄存器可以拆成两个8位的寄存器，AH、AL
## 字在寄存器中的存储
字：两个字节 16位，低字节和高字节
字节：8位

## 几条汇编指令

相加之后，需要保存的数据，不能保存，由于位数不够

AH和AL 是两个完全独立的寄存器，如果相加得到的数超出8位，不会进到高8位

计算和传输时，操作对象的位数必须是一致的

31A3

AX = 671EH
BX = 6246H
AL + BH = 1E + 62 = 
AX = 801E
ah + bl = 80 + 46 = C6 

## 物理地址
AX = C61E


# 安装和配置环境

VIM

# 数字表示

- `感受位的概念`

![](https://user-gold-cdn.xitu.io/2020/7/20/1736c4b46615013d?w=1435&h=718&f=png&s=172110)

重点体会位的概念，将十进制数，拆分成，在二进制数轴中找到对应的位置，就是二进制数。

![](https://user-gold-cdn.xitu.io/2020/7/20/1736c53d35396bcc?w=1490&h=763&f=png&s=233538)

同样的道理，在16进制中使用，`位的概念太重要`了，同样的数字在不同的位表示不同的数量

![](https://user-gold-cdn.xitu.io/2020/7/20/1736c5956fd5860a?w=1429&h=754&f=png&s=311253)

**16进制数，转成二进制数**

![](https://user-gold-cdn.xitu.io/2020/7/20/1736c611b6a6222f?w=1272&h=634&f=png&s=171797)

## 汇编

![](https://user-gold-cdn.xitu.io/2020/7/22/17376f69028f4eee?w=695&h=187&f=png&s=221525)
1. CPU 怎样从内存中读取指令
2. 

## 内存的最小单位

![](https://user-gold-cdn.xitu.io/2020/7/22/17376fb4e30445fd?w=1282&h=419&f=png&s=305619)

## CPU如何从内存中读取字节

![](https://user-gold-cdn.xitu.io/2020/7/22/17376ff46ac9ccc7?w=852&h=753&f=png&s=462782)

## 内存编号为什么是从0开始的

![](https://user-gold-cdn.xitu.io/2020/7/22/17377005d35e1713?w=596&h=506&f=png&s=198526)

## 什么是寻址能力


![](https://user-gold-cdn.xitu.io/2020/7/22/173770a2c6f1a061?w=1002&h=607&f=png&s=414888)

## 练习题 - 寻址能力


![](https://user-gold-cdn.xitu.io/2020/7/22/173770beeb9b327a?w=1149&h=613&f=png&s=577436)

## 数据线 控制线


![](https://user-gold-cdn.xitu.io/2020/7/22/173770d3aa194c2d?w=1385&h=703&f=png&s=172381)


![](https://user-gold-cdn.xitu.io/2020/7/22/173770e327f61d62?w=1312&h=625&f=png&s=563586)

## 计算机如何进行计算？


![](https://user-gold-cdn.xitu.io/2020/7/22/1737712af887bae1?w=1192&h=777&f=png&s=614877)

## 增加对内存的认识


![](https://user-gold-cdn.xitu.io/2020/7/22/1737717d1e330c42?w=1012&h=524&f=png&s=303304)


![](https://user-gold-cdn.xitu.io/2020/7/22/1737718bc48572ea?w=1184&h=560&f=png&s=417076)


![](https://user-gold-cdn.xitu.io/2020/7/22/17377193218da2ae?w=1146&h=496&f=png&s=442849)


![](https://user-gold-cdn.xitu.io/2020/7/22/173771987b229a84?w=1073&h=664&f=png&s=147122)

## RAM内存和ROM内存


![](https://user-gold-cdn.xitu.io/2020/7/22/173771c637db2ecd?w=1152&h=640&f=png&s=234544)


![](https://user-gold-cdn.xitu.io/2020/7/22/173771c996e32d0b?w=1229&h=590&f=png&s=528392)
## 冯诺依曼体系结构

![](https://user-gold-cdn.xitu.io/2020/7/22/1737720037ea84ef?w=1337&h=750&f=png&s=802810)


![](https://user-gold-cdn.xitu.io/2020/7/22/1737720c12226e87?w=1394&h=688&f=png&s=950540)
## 输入设备和输出设备

外设和端口号

![](https://user-gold-cdn.xitu.io/2020/7/22/1737727af66a5010?w=1270&h=653&f=png&s=239806)

![](https://user-gold-cdn.xitu.io/2020/7/22/17377280deaaaa17?w=567&h=241&f=png&s=107141)
![](https://user-gold-cdn.xitu.io/2020/7/22/173772739a98e4c8?w=1057&h=782&f=png&s=378563)

## 关于显存的一个问题

从内存和端口中读取数据
![](https://user-gold-cdn.xitu.io/2020/7/22/1737729be13a65ea?w=866&h=641&f=png&s=215241)

## 承上启下(1)
![](https://user-gold-cdn.xitu.io/2020/7/22/173772c69ae2696c?w=1224&h=750&f=png&s=439745)
## 承上启下(2)

![](https://user-gold-cdn.xitu.io/2020/7/22/173772ded8843cc2?w=866&h=488&f=png&s=326894)

-d -r

![](https://user-gold-cdn.xitu.io/2020/7/22/173772feb799f736?w=991&h=591&f=png&s=440993)


![](https://user-gold-cdn.xitu.io/2020/7/22/173773101510df38?w=1210&h=529&f=png&s=542117)


![](https://user-gold-cdn.xitu.io/2020/7/22/1737731ae7d80cb9?w=802&h=156&f=png&s=148182)

## 重要的技能 - 根据内存地址数内存(1)

![](https://user-gold-cdn.xitu.io/2020/7/22/1737734b366d9b32?w=527&h=800&f=png&s=387301)
## 重要的技能 - 根据内存地址数内存(2)

## 我们为什么要学习汇编语言(1)

![](https://user-gold-cdn.xitu.io/2020/7/22/173773c374e31b9f?w=1329&h=845&f=png&s=529306)

## 我们为什么要学习汇编语言(2

## 提高对输入-计算-输出的认识(1)


![](https://user-gold-cdn.xitu.io/2020/7/25/1738547f841af94d?w=2016&h=509&f=png&s=884222)

## 提高对输入-计算-输出的认识(2)
![](https://user-gold-cdn.xitu.io/2020/7/25/173854c2526ea538?w=1286&h=671&f=png&s=946712)

![](https://user-gold-cdn.xitu.io/2020/7/25/173854cab4472eda?w=1273&h=557&f=png&s=376523)

![](https://user-gold-cdn.xitu.io/2020/7/25/173854d05e433b11?w=1102&h=354&f=png&s=236857)

## 计算
数学题可以拆解，那程序也是可以拆解的

----

使用debug调试汇编程序，例如test.asm

debug test.asm

r p q
CX 寄存器

loop指令