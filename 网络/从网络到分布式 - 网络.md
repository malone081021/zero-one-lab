### 从网络到分布式 - 网络

![image-20200907201236873](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20200907201236873.png)

## 三次握手，四次分手

1. 资源的创建，记录各种的状态，这是三次握手。补充细节
2. 销毁之前创建的资源，要经过四次的沟通。补充细节
3. 描述详细的过程

nestat -natp

service mesh

route -n

## 网络层

![image-20200907212237305](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20200907212237305.png)

## 下一跳

arp -a

![image-20200907214224898](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20200907214224898.png)

**ARP**: 获取局域网中各个机器IP和mac地址对应关系

发生在网络通信之前

网络报中包括，目标IP,源IP,目标mac,源mac

经过路由修改的是目标Mac

mac是链路层封装的

IP是网络层封装的，确定下一跳IP【路由表】，在通过链路层，确定下一跳mac地址

![image-20200907222536131](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20200907222536131.png)



**每一跳，IP不变，mac修改**

通过**IP**和**子网掩码**计算 **网关**，也就是下一跳

学习**配置路由表**，**创建虚拟网卡**

## 分流

![image-20200908042523883](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20200908042523883.png)



四层负载均衡，**只看IP**，直接转发，在第四层

CRC校验

修改原地址 S-NET

D-NET，目标地址转化

非对称

自行车 到 汽车

不经过D-NET 服务器

---

**直接返回，不经过D-NET 服务器，对外隐藏，对内可见**

![image-20200908050809865](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20200908050809865.png)



**来和回不是一条路**

IP 是端到端的

mac是下一跳的

DR 模型，直接路由

---

**IP 包背着 IP 包**

**LVS**

---

