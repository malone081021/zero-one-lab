# 编译的全过程都悄悄做了哪些事情？

编译出知识的整理

程序运行的简单描述:如果源代码编译后要在操作系统上运行，那目标代码就是汇编代码，我们再通过汇编和链接的过程形成可执行文件，然后通过加载器加载到操作系统里执行

编译的简单解释，从源代码到目标代码的过程，一般是汇编代码

## 词法分析

Token 化，识别整个源码中每个单词、关键字、符号等等

## 语法分析

给句子分析语法结构，主谓宾等等

就是各种语法的实例，例如函数，就包括，返回值、函数名，参数、函数体等等。

使用Token构建抽象语法书 AST

## 语义分析

语义分析的重要特点，就是做**上下文相关的分析**,

指代替换，例如a,到底是那个，全局的还是局部的等等

将分析的信息写在AST 中，就构成了带标注信息的AST

##  中间代码

基于中间代码优化

1. 源代码更考虑人的表达方便，目标代码更考虑高效
2. 错误或者不好的表达，优化替代，在不影响结果的情况下

## 生成目标代码

1. 选择合适的指令
2. 优化寄存器
3. 指令重排，充分利用CPU的并行能力

![](https://static001.geekbang.org/resource/image/70/a5/706f4e0f50ab6ce77fd6246cb8cea0a5.jpg)